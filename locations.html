{% extends "base.html" %}

{% block content %}
<div class="header">
    <h1><i class="fas fa-map-marker-alt"></i> Locations Management</h1>
    <button class="btn btn-primary" onclick="toggleForm()">
        <i class="fas fa-plus"></i> Add Location
    </button>
</div>

<div id="locationForm" class="form-container" style="display: none;">
    <h3>Add New Location</h3>
    <form method="POST" action="{{ url_for('add_location') }}">
        <div class="form-group">
            <label for="location_id">Location ID:</label>
            <input type="text" id="location_id" name="location_id" required
                   placeholder="Enter location ID (e.g., WAREHOUSE_A)">
        </div>
        <div class="form-actions">
            <button type="submit" class="btn btn-success">
                <i class="fas fa-save"></i> Save Location
            </button>
            <button type="button" class="btn btn-secondary" onclick="toggleForm()">
                <i class="fas fa-times"></i> Cancel
            </button>
        </div>
    </form>
</div>

<div class="table-container">
    <table class="data-table">
        <thead>
            <tr>
                <th>Location ID</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for location in locations %}
            <tr>
                <td>{{ location.location_id }}</td>
                <td class="actions">
                    <button class="btn btn-warning btn-sm"
                            onclick="editLocation('{{ location.location_id }}')">
                        <i class="fas fa-edit"></i> Edit
                    </button>
                    <a href="{{ url_for('delete_location', location_id=location.location_id) }}"
                       class="btn btn-danger btn-sm"
                       onclick="return confirm('Are you sure you want to delete this location?')">
                        <i class="fas fa-trash"></i> Delete
                    </a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Edit Form (hidden by default) -->
<div id="editForm" class="form-container" style="display: none;">
    <h3>Edit Location</h3>
    <form method="POST" id="editLocationForm">
        <div class="form-group">
            <label for="edit_location_id">Location ID:</label>
            <input type="text" id="edit_location_id" name="location_id" required>
        </div>
        <div class="form-actions">
            <button type="submit" class="btn btn-success">
                <i class="fas fa-save"></i> Update Location
            </button>
            <button type="button" class="btn btn-secondary" onclick="hideEditForm()">
                <i class="fas fa-times"></i> Cancel
            </button>
        </div>
    </form>
</div>

<script>
function toggleForm() {
    const form = document.getElementById('locationForm');
    form.style.display = form.style.display === 'none' ? 'block' : 'none';
}

function editLocation(locationId) {
    document.getElementById('edit_location_id').value = locationId;
    document.getElementById('editLocationForm').action = "{{ url_for('edit_location', location_id='') }}" + locationId;
    document.getElementById('editForm').style.display = 'block';
}

function hideEditForm() {
    document.getElementById('editForm').style.display = 'none';
}
</script>
{% endblock %}